<div class="content">
  <div class="title">
    <h2><i class="fas fa-feather-alt"></i> 投稿する</h2>
  </div>
  <div class="form-style">
    <%= form_with model: @article, local: true do |f| %>

      <!--画像-->
      <div class="field">
        <%= f.label :article_image, "画像" %>
        <%= f.attachment_field :article_image, autofocus: true, autocomplete: "artical_image" %>
      </div>

      <!--品種名-->
      <div class="field">
        <%= f.label :cultivar_name, "品種名" %>
        <%= f.text_field :cultivar_name, autofocus: true, autocomplete: "cultivar_name", class: "item" %>
      </div>

      <!--都道府県-->
      <div class="field">
        <%= f.label :prefecture, "都道府県" %>
        <%= f.collection_select :prefecture, Prefecture.all, :id, :name, prompt: "選択してください" %>
      </div>

      <!--市区町村-->
      <div class="field artical_municipality_area">
        <%= render "public/articles/municipality-select", f: f, prefecture_id: Prefecture.first.id %>
      </div>

      <!--難易度-->
      <!--時期-->
      <!--肥料-->
      <!--場所-->
      <!--条件-->
      <!--開始時-->
      <!--タグ-->
      <!--メッセージ-->

      <div class="actions">
        <%= f.submit "投稿する", class: "btn btn-green" %>
      </div>

    <% end %>
  </div>
</div>

<script>
  $(document).on('change', '#article_prefecture', function() {
    return $.ajax({
      type: 'GET',
      url: '/articles/get_municipalities',
      data: {
        prefecture_id: $(this).val()
      }
    }).done(function(data) {
      return $('.artical_municipality_area').html(data);
    });
  });
</script>